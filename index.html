<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title>SpLink Pro.AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .loader { border-top-color:#00e0ff; animation: spin 1.2s linear infinite; }
        @keyframes spin { 0%{transform:rotate(0)} 100%{transform:rotate(360deg)} }
        
        /* Mobile Responsive Styles */
        @media (max-width: 640px) {
            body {
                padding: 8px;
            }
            h1 {
                font-size: 1.75rem !important;
                margin-bottom: 1rem !important;
            }
            .exercise-btn {
                padding: 12px 16px !important;
            }
            .exercise-btn .text-xl {
                font-size: 1rem !important;
            }
            .exercise-btn .text-sm {
                font-size: 0.75rem !important;
            }
            #testArea .relative {
                aspect-ratio: 3/4 !important; /* Portrait for mobile */
            }
            #startBtn, #backBtn {
                padding: 12px 16px !important;
                font-size: 0.875rem !important;
            }
            #resultPanel {
                padding: 12px !important;
            }
            #resultContent {
                font-size: 0.875rem !important;
            }
            #resultContent h2 {
                font-size: 1.25rem !important;
            }
            .controls-row {
                flex-direction: column !important;
                gap: 8px !important;
            }
            .controls-row button {
                width: 100% !important;
                margin: 0 !important;
            }
        }
        
        /* Camera Selection Modal */
        .camera-modal {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }
        .camera-modal-content {
            background: #1f2937;
            border-radius: 12px;
            padding: 24px;
            max-width: 320px;
            width: 90%;
            text-align: center;
        }
        .camera-btn {
            width: 100%;
            padding: 16px;
            margin: 8px 0;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: transform 0.2s, background 0.2s;
        }
        .camera-btn:active {
            transform: scale(0.98);
        }
    </style>
</head>

<body class="bg-gray-900 text-white flex flex-col items-center justify-start md:justify-center min-h-screen p-2 md:p-4">

<div class="w-full max-w-3xl">
    <h1 class="text-center text-2xl md:text-4xl font-bold text-cyan-300 mb-4 md:mb-6">SpLink Pro.AI</h1>

    <!-- Exercise Selection Menu (shown by default) -->
    <div id="exerciseMenu" class="bg-gray-800 rounded-lg p-4 md:p-8 shadow-xl mb-4 md:mb-6">
        <h2 class="text-xl md:text-2xl font-semibold text-cyan-300 mb-4 md:mb-6 text-center">Select Exercise</h2>
        <div class="grid grid-cols-2 md:grid-cols-2 gap-2 md:gap-4">
            <button data-exercise="forward-bend" class="exercise-btn bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 px-3 md:px-6 py-3 md:py-4 rounded-lg font-semibold shadow-lg transition transform hover:scale-105 active:scale-95">
                <div class="text-base md:text-xl mb-1">üßò Forward Bend</div>
                <div class="text-xs md:text-sm text-purple-200">Flexibility Test</div>
            </button>
            <button data-exercise="squat" class="exercise-btn bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 px-3 md:px-6 py-3 md:py-4 rounded-lg font-semibold shadow-lg transition transform hover:scale-105 active:scale-95">
                <div class="text-base md:text-xl mb-1">üèãÔ∏è Squat</div>
                <div class="text-xs md:text-sm text-blue-200">Lower Body Strength</div>
            </button>
            <button data-exercise="high-knee" class="exercise-btn bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 px-3 md:px-6 py-3 md:py-4 rounded-lg font-semibold shadow-lg transition transform hover:scale-105 active:scale-95">
                <div class="text-base md:text-xl mb-1">üèÉ High Knee</div>
                <div class="text-xs md:text-sm text-green-200">Dynamic Mobility</div>
            </button>
            <button data-exercise="t-pose" class="exercise-btn bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 px-3 md:px-6 py-3 md:py-4 rounded-lg font-semibold shadow-lg transition transform hover:scale-105 active:scale-95">
                <div class="text-base md:text-xl mb-1">ü¶© T-Pose Balance</div>
                <div class="text-xs md:text-sm text-yellow-200">Single Leg Stability</div>
            </button>
            <button data-exercise="plank" class="exercise-btn bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 px-3 md:px-6 py-3 md:py-4 rounded-lg font-semibold shadow-lg transition transform hover:scale-105 active:scale-95 col-span-2">
                <div class="text-base md:text-xl mb-1">üí™ Elbow Plank Hold</div>
                <div class="text-xs md:text-sm text-red-200">Core Endurance</div>
            </button>
        </div>
    </div>

    <div id="testArea" class="hidden">
    <div class="relative w-full aspect-video md:aspect-video bg-black rounded-lg overflow-hidden shadow-xl mobile-video-container">
        <!-- Loading indicator -->
        <div id="loading" class="absolute inset-0 bg-black bg-opacity-70 flex flex-col items-center justify-center">
            <div class="loader w-16 h-16 md:w-20 md:h-20 rounded-full border-8 border-gray-500 border-t-cyan-400 mb-4"></div>
            <p class="text-base md:text-lg">Loading AI model...</p>
        </div>

        <!-- Video feed -->
        <video id="webcam" autoplay playsinline class="absolute w-full h-full"
               style="object-fit:contain; transform:scaleX(-1); background:#000;"></video>

        <!-- Pose landmark canvas -->
        <canvas id="canvas" class="absolute w-full h-full"></canvas>

        <!-- Result overlay (hidden until test finish) -->
        <div id="resultPanel" class="hidden absolute inset-0 bg-black bg-opacity-85 text-white p-4 md:p-6 overflow-auto" style="z-index:50; display:none;">
            <div id="resultContent" class="max-w-2xl mx-auto text-center"></div>
            <div class="text-center mt-4 md:mt-6 flex justify-center gap-3 md:gap-4">
                <button id="retryExercise" class="bg-yellow-500 hover:bg-yellow-600 text-gray-900 px-4 md:px-6 py-2 rounded font-semibold text-sm md:text-base">RETRY</button>
                <button id="acceptResults" class="bg-green-500 hover:bg-green-600 text-white px-4 md:px-6 py-2 rounded font-semibold text-sm md:text-base">ACCEPT</button>
            </div>
        </div>
    </div>

    <!-- Controls -->
    <div class="text-center mt-3 md:mt-4 flex flex-wrap justify-center gap-2 md:gap-4 items-center">
        <div>
            <label for="distanceMode" class="text-xs md:text-sm text-gray-300 mr-1 md:mr-2">Distance</label>
            <select id="distanceMode" class="bg-gray-700 text-white px-2 md:px-3 py-1.5 md:py-2 rounded-lg border border-gray-600 text-sm">
                <option value="2m" selected>2 meters</option>
                <option value="1m">1 meter</option>
            </select>
        </div>
        <div id="cameraSelectWrapper" class="hidden">
            <label for="cameraSelect" class="text-xs md:text-sm text-gray-300 mr-1 md:mr-2">Camera</label>
            <select id="cameraSelect" class="bg-gray-700 text-white px-2 md:px-3 py-1.5 md:py-2 rounded-lg border border-gray-600 text-sm">
                <option value="user">Front</option>
                <option value="environment">Back</option>
            </select>
        </div>
    </div>
    <div class="text-center mt-4 md:mt-6 flex flex-col md:flex-row justify-center gap-3 md:gap-4 controls-row">
        <button id="backBtn" class="bg-gray-600 hover:bg-gray-700 px-4 md:px-6 py-2.5 md:py-3 rounded-lg font-bold shadow-lg text-sm md:text-base">
            ‚Üê BACK TO MENU
        </button>
        <button id="startBtn"
                class="bg-cyan-500 hover:bg-cyan-600 px-4 md:px-6 py-2.5 md:py-3 rounded-lg font-bold shadow-lg text-sm md:text-base">
            START TEST
        </button>
    </div>
    </div>

    <!-- Camera Selection Modal (for mobile) -->
    <div id="cameraModal" class="camera-modal hidden">
        <div class="camera-modal-content">
            <h3 class="text-xl font-bold text-cyan-300 mb-4">Select Camera</h3>
            <p class="text-gray-300 text-sm mb-4">Choose which camera to use for pose detection</p>
            <button id="selectFrontCamera" class="camera-btn bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white">
                <span class="text-2xl">ü§≥</span>
                <span>Front Camera</span>
            </button>
            <button id="selectBackCamera" class="camera-btn bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white">
                <span class="text-2xl">üì∑</span>
                <span>Back Camera</span>
            </button>
            <button id="cancelCameraSelect" class="camera-btn bg-gray-600 hover:bg-gray-700 text-white mt-2">
                <span>Cancel</span>
            </button>
        </div>
    </div>
</div>

<!-- Load main application module -->
<script type="module" src="main.js?v=2"></script>

</body>
</html>

